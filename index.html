<!DOCTYPE html>
<!--
Judges, this was very mentally taxing, so I request that I be given no less than this score:

-> i <-

or, -> sqrt(-1) <- if you don't know what i is!

Also, please be patient while playing! I know the game takes quite a bit of time to load the next scene but that's no reason to get bored.

I took ski's advice and ran my code through an HTML  beautifier, so none of you judges can complain about my code's cleanliness!

Also, judges, please don't lower my score because of how hard the game is. Please?

Please report bugs/inconvieniences. There are probably a lot.

-->
<html>

<head>
    <meta charset="utf-8">
    <title>Primavera Challenge 1</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;0,1000;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900;1,1000&display=swap" rel="stylesheet">
    <style>
        body{
                margin: 0;
                font-family: Nunito, 'sans-serif';
                overflow: hidden;
                color: white;
                font-style: italic;
            }
            @keyframes breathe {
                /*I mean... they gotta breathe ._.*/
                0%{
                    transform: skewX(-0.5deg) translateX(3px);
                }
                50%{
                    transform: skewX(0.5deg) translateX(4px);
                }
                100%{
                    transform: skewX(-0.5deg) translateX(3px);
                }
            }
            @keyframes upa{
                /*Basic */
                25%{
                    margin-left: 75px;
                }
            }
            @keyframes epa{
                25%{
                    margin-left: -75px;
                }
            }
            @keyframes glow{
                20%{
                    filter: brightness(2.2);
                }
                80%{
                    filter: brightness(2.2);
                }
            }
            @keyframes water{
                30%{
                    filter: sepia(90%) saturate(300%) brightness(75%) hue-rotate(180deg);
                }
                70%{
                    filter: sepia(90%) saturate(300%) brightness(75%) hue-rotate(180deg);
                }
            }
            @keyframes bubblebeam{
                0%{
                    opacity: 0;
                }
                40%{
                    opacity: 1;
                }
                100%{
                    left: 100px;
                    top: 300px;
                    opacity: 0;
                }
            }
            @keyframes fire{
                30%{
                    filter: brightness(2) hue-rotate(50deg);
                }
            }
            @keyframes firebeam{
                0%{
                    opacity: 0;
                }
                40%{
                    opacity: 1;
                }
                50%{
                    filter: brightness(1);
                }
                100%{
                    left: 98px;
                    top: 252px;
                    opacity: 0;
                    filter: brightness(4);
                }
            }
            @keyframes glow_faint{
                20%{
                    filter: brightness(1.5);
                }
                80%{
                    filter: brightness(1.5);
                }
            }
            @keyframes magus_attack{
                15%{
                    width: 15px;
                    height: 15px;
                    
                }
                30%{
                    opacity: 1;
                    filter: brightness(1)
                }
                100%{
                    width: 15px;
                    height: 15px;
                    opacity: 0;
                    filter: brightness(2);
                }

            }
            @keyframes heal{
                30%{
                    opacity: 1;
                }
                100%{
                    left: 100px;
                    top: 300px;
                    opacity: 0;
                }
            }
            @keyframes heal2{
                30%{
                    opacity: 1;
                }
                100%{
                    left: 500px;
                    top: 300px;
                    opacity: 0;
                }
            }
            @keyframes heal3{
                30%{
                    opacity: 1;
                }
                100%{
                    left: 426px;
                    top: 246px;
                    opacity: 0;
                }
            }
            @keyframes fade_in{
                0%{
                    opacity: 0;
                }
                100%{
                    opacity: 1;
                }
            }
            @keyframes fade_out{
                100%{
                    opacity: 0;
                }
                0%{
                    opacity: 1;
                }
            }
            #upgrade{
                width: 100vw;
                height: 150px;
                position: absolute;
                background: black;
                top: -150px;
                z-index: 1;
                transition: all 1s;
            }
            #stat_button{
                display: flex;
                width: 91px;
                transform: scale(1.3);
                background-color: grey;
                justify-content: center;
                margin-bottom: 13px;
                margin-top: 15px;
                margin-left: 30px;
                margin-right: 30px;
                transition: all 0.3s;
            }
            #stat_button:hover{
                background-color: #999999;
                cursor: pointer;
            }
            .select_move{
                display: flex;
                width: 53vw;
                height: 20px;
                transform: scale(1.3);
                background-color: grey;
                margin-left: 47px;
                margin-top: -5px;
                margin-bottom: 16px;
                font-size: 12px;
                transition: all 0.3s;
            }
            .select_move:hover{
                background-color: #999999;
                cursor: pointer;
            }
            #move_box{
                width: 136px;
                height: 79px;
                background: grey;
                position: absolute;
                top: 131px;
                left: 38px;
                opacity: 0;
                margin: 0px;
                padding: 0px;
            }
            #select_player{
                width: 105px;
                height: 22px;
                background: grey;
                position: absolute;
                top: 359px;
                left: 247.5px;
                margin: 0px;
                padding: 0px;
                opacity: 0;
                text-align: center;
            }
            #select_player1{
                width: 117px;
                height: 22px;
                background: grey;
                position: absolute;
                top: 194px;
                left: 446px;
                margin: 0px;
                padding: 0px;
                opacity: 0;
                text-align: center;
                z-index: 1;
                transition: 0.3s all;
            }
            #select_player2{
                width: 117px;
                height: 22px;
                background: grey;
                position: absolute;
                top: 144px;
                left: 377px;
                margin: 0px;
                padding: 0px;
                opacity: 0;
                text-align: center;
                z-index: 1;
                transition: 0.3s all;
            }
            #select_player1:hover{
                background: #aaaaaa;
            }
            #select_player2:hover{
                background: #aaaaaa;
            }
            .move_button{
                color: black;
                background-color: white; 
                width: 40px; 
                text-align: center;
                transition: all 0.2s;
            }
            .move_button:hover{
                background-color: #dddddd;
            }
    </style>
</head>

<body>
    <!--Move box, consists of Altum's moves-->
    <div id="move_box">
        <p style="font-size: 14px; margin: 3px -0px -13.5px 3px"><i>Available Moves</i></p>
        <div style="display: flex; font-size: 12px; margin: 0px 0px -22px 3px">
            <p id="curr_move"></p>
            <p>&nbsp;</p>
            <p id="stat"></p>
        </div>
        <div style="display: flex; font-size: 12px; margin: -25px 0px -22px 3px">
            <p>Energy Needed:</p>
            <p>&nbsp;</p>
            <p id="en"></p>
        </div>
        <div style="display: flex; font-size: 13px; margin: 0px 0px 0px 3px">
            <p id="use" class="move_button" style="margin-left: 15.5px; " onclick="">Use</p>
            <p id="next" class="move_button" style="margin-left: 20px;" onclick="">Next</p>
        </div>
    </div>

    <!--Select target prompt-->
    <div id="select_player">
        <p style="margin: 0 2px;">Select Target</p>
    </div>

    <!--Select target 1 prompt-->
    <div id="select_player1">
        <p style="margin: 0 2px;">Select Target 1</p>
    </div>

    <!--Select target 2 prompt-->
    <div id="select_player2">
        <p style="margin: 0 2px;">Select Target 2</p>
    </div>

    <!--Upgrade box-->
    <div id="upgrade">
        <div style="display: flex">
            <!--Upgrade stats-->
            <div>
                <div id="stat_button" onclick="us(0)">
                    <p style="margin: 0">Attack:&nbsp</p>
                    <p id="power_stat" style="margin: 0">20</p>
                </div>
                <div id="stat_button" onclick="us(1)">
                    <p style="margin: 0">Vitality:&nbsp</p>
                    <p id="vitality_stat" style="margin: 0">20</p>
                </div>
                <div id="stat_button" onclick="us(2)">
                    <p style="margin: 0">Speed:&nbsp</p>
                    <p id="speed_stat" style="margin: 0">0</p>
                </div>
                <div style="display:flex; margin-top: -17px; margin-left: 10px">
                    <p>Upgrade Points:&nbsp</p>
                    <p id="up">2</p>
                </div>
            </div>

            <!--Get a new move-->
            <div>
                <h3 style="margin-top: 16px">Select a move to recieve:</h3>
                <div class="select_move" id="am" onclick="rm(0)">
                    <p style="margin: 2.5px" id="amd">Bite: 3 energy | Deal 1.5x attack stat</p>
                </div>
                <div class="select_move" id="hm" onclick="rm(1)">
                    <p style="margin: 2.5px" id="hmd">Rest: 4 energy | Heal by 2.5x vitality stat</p>
                </div>
                <div class="select_move" id="bm" onclick="rm(2)">
                    <p style="margin: 2.5px" id="bmd">Energetic: 0 energy | +1 energy for 5 turns</p>
                </div>
            </div>

            <!--Start next round-->
            <a style="margin-left: -110px; margin-top: 19px; color: white" href="#" onclick="nextRound()">Start Next Round!</a>
        </div>
    </div>
</body>
<script>
    //Some variables
    var wt = 0;
            var pmb = false;
            var pe = 10;
            var pd = false;
            var pE = 0;
            var pc = 1;
            var ed1 = false;
            var ed2 = false;
            var am = 0;
            var hm = 0;
            var bm = 0;
            var cbm = false;
            //Moves and their descriptions
            var r_moves = [
                ["Bite", ": 3 energy | Deal 1.5x attack stat", "Pounce", ": 5 energy | Deal 2x attack stat", "Werewolf", ": 10 energy | Deal 250 dmg", "", ""],
                ["Rest", ": 4 energy | Heal by 2.5x vitality stat", "Meditate", ": 6 energy | Double current HP", "Moonlight", ": 10 energy | Full heal and +1 energy for 5 turns", "", ""],
                ["Energetic", ": 0 energy | +1 energy for 5 turns", "Charge", ": 3 energy | 1.5x damage next attack only", "Skip", ": 0 energy | 50% less damage", "", ""]
            ];
            //Your current level
            var level = 1 - 1;
            //Your current moves
            var moves = ["Paw Slash", "Lick Wounds", "Defend", "Pass"];
            //Your current stats
            var stats = [20, 20, 0];
            
            //I was too lazy to test the game so I just gave myself boss stats ;-;
            //var stats = [200, 200, 100];
            
            //Battle stats (primarily enemy stats)
            var bs = [
                [[0, stats[2]], [1, 1]],
                ["basic", 20],
                [30]
            ];
            //Avatar images
            var avatars = [
                ["https://www.khanacademy.org/computer-programming/virtus-seed/5402185715466240", "https://www.khanacademy.org/computer-programming/opes-seed/6754744736727040", "https://www.khanacademy.org/computer-programming/altum-seed/4771060311703552", "https://www.khanacademy.org/computer-programming/magus-seed/6052648118960128", "https://www.khanacademy.org/computer-programming/aequor-seed/5314629921456128", "https://www.khanacademy.org/computer-programming/cinis-seed/4751662628782080"],
                ["https://www.khanacademy.org/computer-programming/virtus-seedling/6563369089024000", "https://www.khanacademy.org/computer-programming/opes-seedling/5411924125990912", "https://www.khanacademy.org/computer-programming/altum-seedling/5318385979408384", "https://www.khanacademy.org/computer-programming/magus-seedling/4983114012344320", "https://www.khanacademy.org/computer-programming/aequor-seedling/6306955649138688", "https://www.khanacademy.org/computer-programming/cinis-seedling/6535067267809280"],
                ["https://www.khanacademy.org/computer-programming/virtus-sapling/5536283427651584", "https://www.khanacademy.org/computer-programming/opes-sapling/5560068419665920", "https://www.khanacademy.org/computer-programming/altum-sapling/5801038163787776", "https://www.khanacademy.org/computer-programming/magus-sapling/5592115183927296", "https://www.khanacademy.org/computer-programming/aequor-sapling/6743880994439168", "https://www.khanacademy.org/computer-programming/cinis-sapling/5425688850251776"],
                ["https://www.khanacademy.org/computer-programming/virtus-tree/6328403138756608", "https://www.khanacademy.org/computer-programming/opes-tree/5990431012995072", "https://www.khanacademy.org/computer-programming/altum-tree/6614087846117376", "https://www.khanacademy.org/computer-programming/magus-tree/5545575010582528", "https://www.khanacademy.org/computer-programming/aequor-tree/5846138499678208", "https://www.khanacademy.org/computer-programming/cinis-tree/5080162262892544"],
                ["https://www.khanacademy.org/computer-programming/virtus-ultimate/6644710929383424", "https://www.khanacademy.org/computer-programming/opes-ultimate/6606899857637376", "https://www.khanacademy.org/computer-programming/altum-ultimate/5545832616345600", "https://www.khanacademy.org/computer-programming/magus-ultimate/4544402942115840", "https://www.khanacademy.org/computer-programming/aequor-ultimate/6651724308987904", "https://www.khanacademy.org/computer-programming/cinis-ultimate/6608220316811264"],
                ];
            //Load avatar onto screen
            function addAvatar(type, rank, dir, s, x, y, name){
                //Make avatar's HP bar
                var hpbar = document.createElement("div");
                hpbar.style.width = "100px";
                hpbar.style.height = "15px";
                hpbar.style.backgroundColor = "#43ff00";
                hpbar.style.left=(x-50) + "px";
                hpbar.style.top=(y-80) + "px";
                hpbar.style.borderRadius = "100px";
                hpbar.id = name + "_hpbar";
                var hp = document.createElement("div");
                hp.style.width = "100px";
                hp.style.height = "15px";
                hp.style.border = "solid 1px #43ff00";
                hp.style.background="white"
                hp.style.position = "relative";
                hp.style.left=(x-50) + "px";
                hp.style.top=(y-80) + "px";
                hp.style.padding = "1.5px";
                hp.style.borderRadius = "100px";
                hp.appendChild(hpbar);
                
                //Make avatar's image
                var avatar = document.createElement("img");
                avatar.src=avatars[rank][type]+"/latest.png";
                avatar.style.position = "fixed";
                avatar.style.width = "210px";
                avatar.style.left=(x-105) + "px";
                avatar.style.top=(y-105) + "px";
                avatar.style.transform="scaleX(" + -dir + ") scale(" + s + ")";
                avatar.style.transition = "all 2s";
                if(rank == 2 && type == 1){
                    avatar.style.transform="scaleX(" + dir + ") scale(" + s + ")";
                }
                if(rank == 3 && type == 2){
                    avatar.style.transform="scaleX(" + dir + ") scale(" + s + ")";
                }
                if(rank == 3 && type == 5){
                    avatar.style.transform="scaleX(" + dir + ") scale(" + s + ")";
                }
                if(rank == 4 && type == 5){
                    avatar.style.transform="scaleX(" + dir + ") scale(" + s + ")";
                }
                
                //Put HP bar and avatar in one div...
                var add = document.createElement("div");
                add.appendChild(hp);
                add.appendChild(avatar);
                add.id = name;
                add.style.position = "absolute";
                add.style.animation = "breathe 2s infinite";
                add.classList.add("battle_item");
                
                //and add the div to the body!
                document.body.appendChild(add);
                }
            //Load battle   
            function makeBattle(pt, pr, et1, er1, et2, er2, bstats){
                //Player's energy
                pe = 10;
                
                //This allows you to buy a move after the battle is over
                cbm = true;
                
                //Sets up some upgrade stats
                document.getElementById("am").style.opacity = 1;
                    document.getElementById("hm").style.opacity = 1;
                    document.getElementById("bm").style.opacity = 1;
                    //Adds in player avatar
                    addAvatar(pt, pr, 1, 0.7, 100, 300, "player");
                    //Adds in enemy avatar 2
                    if(et2 != -1){
                        addAvatar(et2, er2, -1, 0.7, 430, 250, "enemy2");
                    }
                    //Adds in enemy avatar 1
                    addAvatar(et1, er1, -1, 0.7, 500, 300, "enemy1");
                    //Sorts avatars by speed; the fastest avatar moves first.
                    bstats[0].sort(function(x, y){
                        if(y[1] > x[1]){
                            return 1;
                        }
                        if(y[1] < x[1]){
                            return -1;
                        }
                        if(x[0] < y[0]){
                            return -1;
                        }
                        else{
                            return 1;
                        }
                    })  
                    //Displays your current energy
                    energy(10);
                    //Whose turn is it?
                    var turn = 0;
                    //What moves will the enemies use?
                    var e1m = 0;
                    var e2m = 0;
                    function loop(){
                        setTimeout(function(){
                            //Sets up energy and some buffs
                            if(turn % bs[0].length == 0){
                                pe++;
                                if(pE > 0){
                                    pe++;
                                    pE--;
                                }
                                pc = 1;
                                pd = false;
                                ed1 = false;
                                ed2 = false;
                                if(pe > 10){
                                    pe = 10;
                                }
                                energy(pe);
                            }
                            
                            //Checks if you're dead
                            if(document.getElementById("player_hpbar").style.width == "0px"){
                                document.body.innerHTML = '';
                                document.body.style.background = "black";
                                document.body.innerHTML = "You died. I thought you would. Click restart to try again. While you're here, you can help me tweak the difficulty level of this game. I've never beaten it, so I suppose it's pretty hard. Comment something like, 'make level 5 easier!' Anyways, click restart. Good luck.";
                                return;
                            }
                            //Checks if your enemies are dead
                            if(bs[0].length == 2){
                                if(document.getElementById("enemy1_hpbar").style.width == "0px"){
                                                    document.getElementById("upgrade").style.top = "0px";
                                                    document.getElementById("up").innerHTML =  parseInt(document.getElementById("up").innerHTML, 10) + 2;
                                    return;
                                }
                            }
                            else{
                                if(document.getElementById("enemy1_hpbar").style.width == "0px" && document.getElementById("enemy2_hpbar").style.width == "0px"){
                                                    document.getElementById("upgrade").style.top = "0px";
                                                    document.getElementById("up").innerHTML = parseInt(document.getElementById("up").innerHTML, 10) + 2;
                                    return;
                                }
                            }
                            
                            //Sets up some stuff
                            var t = turn % bs[0].length;
                            document.getElementById("enemy1").style.animation="breathe 2s infinite";
                            if(et2 != -1){
                            document.getElementById("enemy2").style.animation="breathe 2s infinite";
                            }
                            document.getElementById("player").style.animation="breathe 2s infinite";
                            
                            if(bstats[0][t][0] != 0){
                                var run = true;
                                //The enemy's move. If they're dead, skip them.
                                if(bstats[0][t][0] == 1){
                                    if(document.getElementById("enemy1_hpbar").style.width == "0px"){
                                        run = false;
                                        turn++;
                                        wt = 0;
                                        loop();
                                    }
                                    else{
                                        move("enemy1", bstats[bstats[0][t][0]][e1m])
                                    }
                                }
                                else{
                                    if(document.getElementById("enemy2_hpbar").style.width == "0px"){
                                        run = false;
                                        turn++;
                                        wt = 0;
                                        loop();
                                    }
                                    else{
                                        move("enemy2", bstats[bstats[0][t][0]][e2m])
                                    }
                                }
                                
                                //If the enemy isn't dead, let their attack animation play out. Set up how much time to wait for next turn.
                                if(run){
                                    switch(bstats[bstats[0][t][0]][0]){
                                        case "magus_magic":
                                            wt = 2000;
                                            break;
                                        case "basic":
                                            wt = 1100;
                                        case "aequor_bubbles":
                                            wt = 2500;
                                            case "fireball":
                                            wt = 2500;
                                    }
                                    hpbarChange(
                                        "player", 
                                        -er((bstats[bstats[0][t][0]][bstats[0][t][0] == 1 ? e1m + 1 : e2m + 1] / (stats[1]*5) * 100) / (pd ? 2 : 1))
                                    )
                                    if(bstats[0][t][0] == 1){
                                        e1m+=2;
                                        e1m %= bstats[1].length;
                                    }
                                    if(bstats[0][t][0] == 2){
                                        e2m+=2;
                                        e2m %= bstats[2].length;
                                    }
                                    turn++;
                                    loop();
                                    
                                }
                            }
                            else{
                                var b = 0;
                                document.getElementById("use").style.cursor = "pointer";
                                document.getElementById("next").style.cursor = "pointer";
                                document.getElementById("use").onclick = playerMove;
                                document.getElementById("next").onclick = nextMove;
                                document.getElementById("curr_move").innerHTML = moves[0];
                                displayStat();
                                document.getElementById("move_box").style.opacity="1";
                                document.getElementById("move_box").style.animation="fade_in 0.4s";
                                var p = setInterval(
                                function(){
                                    
                                    if(pmb){
                                        clearInterval(p);
                                        turn++;
                                        wt = 1500;
                                        document.getElementById("move_box").style.animation="fade_out 0.4s";
                                        document.getElementById("move_box").style.opacity="0";
                                        document.getElementById("use").style.cursor = "";
                                document.getElementById("next").style.cursor = "";
                                document.getElementById("use").onclick = "";
                                document.getElementById("next").onclick = "";
                                pe -= document.getElementById("en").innerHTML;
                                energy(pe);
                                        pmb = false;
                                        loop();
                                    }
                                    
                                }, 1000);
                            }
                        }, (turn == 0 ? 0 : wt + 1000));
                    }
                    loop();
            }
            
            //Changes the hpbar value
            function hpbarChange(name, inc){
                    var hpBar = document.getElementById(name+"_hpbar");
                    var c = setInterval(change, 20);
                    var dir = 1;
                    var to = parseInt(hpBar.style.width, 10) + inc
                    if(to > 100) to = 100;
                    if(parseInt(hpBar.style.width, 10) < to){
                        dir = -1;
                    }
                function change(){
                    if(parseInt(hpBar.style.width, 10) == to){
                        clearInterval(c);
                    }
                        var topVal = parseInt(hpBar.style.width, 10);
                        if(topVal != to){
                            hpBar.style.width=topVal-2*dir + "px";
                            hpBar.style.background="rgba(" + (67+3.5*(100-(parseInt(hpBar.style.width, 10)))) + ", " + (255-1.4*(100-parseInt(hpBar.style.width, 10))) + ", " + (0+1*(100-(parseInt(hpBar.style.width, 10)))) + ", 1)"
                        }
                    }
                }
            
            //Displays energy
            function energy(num){
                //stole this from stackoverflow ;-;
                var dep = document.getElementsByClassName('energy_point');

                while(dep[0]) {
                    dep[0].parentNode.removeChild(dep[0]);
                }
                for(var i = 0; i < num; i++){
                    var ep = document.createElement("div");
                    ep.style.position = "absolute";
                    ep.style.width = "10px";
                    ep.style.height = "19px";
                    ep.style.left = (i*15+33) + "px"
                    ep.style.top = "360px"
                    ep.style.background = "#aa00aa"
                    ep.classList.add('energy_point')
                    document.body.appendChild(ep);
                }
            }
            
            //Literally all the move animations
            function move(name, attack){
                if(attack == "basic"){
                        if(name == "player"){
                            document.getElementById(name).style.animation="upa 0.5s, breathe 2s infinite";
                        }
                        else{
                            document.getElementById(name).style.animation="epa 0.5s, breathe 2s infinite";
                        }
                    }
                if(attack == "heal"){
                    var i = 0;
                    function outerLoop(){
                    setTimeout(
                        function loop(){
                            var circ = document.createElement("div");
                            circ.style.width = "20px";
                            circ.style.height = "20px";
                            circ.style.borderRadius ="100%";
                            circ.style.position = "absolute";
                            circ.style.left = (92 + Math.sin(i * 60 * Math.PI/180)*40) + "px";
                            circ.style.top = (287 + Math.cos(i * 60 * Math.PI/180)*40) + "px";
                            circ.style.opacity = "0";
                            circ.style.animation = "heal 2s";
                            circ.style.background = "#00ff66";
                            document.body.appendChild(circ);
                            i++;
                            if(i < 6){
                                outerLoop();
                            }
                        }, 100);
                    }
                    outerLoop();
                }
                if(attack == "buff"){
                    var i = 0.5;
                    document.getElementById(name).style.animation = "glow_faint 2s, breathe 2s infinite";
                    if(name == "enemy1"){
                        ed1 = true;
                    }
                    if(name == "enemy2"){
                        ed2 = true;
                    }
                    function outerLoop(){
                    setTimeout(
                        function loop(){
                            var circ = document.createElement("div");
                            circ.style.width = "20px";
                            circ.style.height = "20px";
                            circ.style.borderRadius ="100%";
                            circ.style.position = "absolute";
                            if(name == "player"){
                                circ.style.left = (92 + Math.sin(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.top = (287 + Math.cos(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.animation = "heal 2s";
                            }
                            else if(name == "enemy1"){
                                circ.style.left = (475 + Math.sin(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.top = (287 + Math.cos(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.animation = "heal2 2s";
                            }
                            else if(name == "enemy2"){
                                circ.style.left = (410 + Math.sin(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.top = (230 + Math.cos(i * 60 * Math.PI/180)*40) + "px";
                                circ.style.animation = "heal3 2s";
                            }
                            circ.style.opacity = "0";
                            circ.style.background = "#ff00dd";
                            document.body.appendChild(circ);
                            i++;
                            if(i < 6){
                                outerLoop();
                            }
                        }, 100);
                    }
                    outerLoop();
                }
                if(attack == "magus_magic"){
                        document.getElementById(name).style.animation="glow 2s, breathe 2s infinite";
                        
                        var i = 0;
                        
                        function loop(){
                        setTimeout(
                            function() {  
                                if(i>10 && i < 15){
                                    i++;
                                    loop();
                                    return;
                                }
                                var mb = document.createElement("div");
                                mb.style.position = "absolute";
                                mb.style.width ="0px";
                                mb.style.height = "0px";
                                mb.style.background="rgb(136, 118, 140)";
                                mb.style.borderRadius="100%";
                                mb.style.top= 265 + i*2 +"px";
                                mb.style.left=(100 + Math.abs(15 - i) * Math.abs(15 - i)*1.7) + "px";
                                mb.style.animation="magus_attack 1s"
                                document.body.appendChild(mb);
                                i++;
                                if(i <= 30){
                                    loop();
                                }
                            },
                            20
                        )
                        }
                        loop();
                    };
                if(attack == "aequor_bubbles"){
                    document.getElementById(name).style.animation="water 2s, breathe 2s infinite";
                    var i = 0;
                    var bubble_attack = setInterval(
                    function(){
                        i++;
                        if(i == 15){
                            clearInterval(bubble_attack);
                        }
                        var bubble = document.createElement("div");
                        bubble.style.width = "20px";
                        bubble.style.height = "20px";
                        bubble.style.position = "absolute";
                        bubble.style.background="#00aaff";
                        bubble.style.borderRadius = "100%";
                        bubble.style.opacity = 0;
                        if(name == "enemy1"){
                            bubble.style.top = "308px";
                            bubble.style.left = "422px";
                        }
                        else{
                            bubble.style.top = "230px";
                            bubble.style.left = "375px";
                        }
                        bubble.style.animation = "bubblebeam 2s";
                        document.body.appendChild(bubble);
                    }
                    , 100);
                }
                if(attack == "fireball"){
                    document.getElementById(name).style.animation="fire 2s, breathe 2s infinite";
                    var i = 0;
                    var bubble_attack = setInterval(
                    function(){
                        i++;
                        if(i == 15){
                            clearInterval(bubble_attack);
                        }
                        var fire = document.createElement("img");
                        fire.src = "https://upload.wikimedia.org/wikipedia/commons/3/3c/Farm-Fresh_bullet_burn.png"
                        fire.style.width = "50px";
                        fire.style.height = "50px";
                        fire.style.position = "absolute";
                        fire.style.borderRadius = "100%";
                        fire.style.opacity = 0;
                        if(name == "enemy1"){
                            fire.style.top = "259px";
                            fire.style.left = "422px";
                        }
                        else{
                            fire.style.top = "200px";
                            fire.style.left = "375px";
                        }
                        fire.style.animation = "firebeam 2s";
                        document.body.appendChild(fire);
                    }
                    , 100);
                }
            }
            
            //Handles player moves
            function playerMove(){
                if(document.getElementById("en").innerHTML > pe){
                    return;
                }
                var attackName = document.getElementById("curr_move").innerHTML;
                if(attackName == "Pass"){
                    pmb = true;
                    return;
                }
                document.getElementById("move_box").style.opacity = "0";
                document.getElementById("move_box").style.animation = "fade_out 0.4s";
                if(attackName == "Paw Slash" || attackName == "Bite"){
                    if(bs[0].length == 3){
                        
                        document.getElementById("select_player").style.opacity = "1";
                        document.getElementById("select_player").style.animation = "fade_in 0.4s";
                        document.getElementById("select_player1").style.opacity = "1";
                        document.getElementById("select_player1").style.cursor = "pointer";
                        document.getElementById("select_player2").style.opacity = "1";
                        document.getElementById("select_player2").style.cursor = "pointer";
                        var interval = setInterval(function(){
                        var elem = document.querySelector('#select_player1');

elem.addEventListener("click", function( event ) {   
    if(event.isTrusted)
    move("player", "basic");
    if(attackName == "Paw Slash"){
        
        hpbarChange("enemy1", -er(stats[0] / bs[bs.length - 1][0] * 100 * pc / (ed1 ? 2 : 1)));
    }
    else{
        
        hpbarChange("enemy1", -er((1.5 * stats[0]) / bs[bs.length - 1][0] * 100 * pc / (ed1 ? 2 : 1)));
    }
    pmb = true;
        clearInterval(interval);
document.getElementById("select_player").style.opacity = "0";
                        document.getElementById("select_player").style.animation = "fade_out 0.4s";
                        document.getElementById("select_player1").style.opacity = "0";
                        document.getElementById("select_player1").style.cursor = "";
                        document.getElementById("select_player2").style.opacity = "0";
                        document.getElementById("select_player2").style.cursor = "";
                        return;
  }, false);
  
  var elem2 = document.querySelector('#select_player2');

elem2.addEventListener("click", function( event ) {   
    if(event.isTrusted)
        move("player", "basic");
        if(attackName == "Paw Slash"){
        hpbarChange("enemy2", -er(stats[0] / bs[bs.length - 1][1] * 100*pc / (ed2 ? 2 : 1)));
    }
    else{
        hpbarChange("enemy2", -er((1.5 * stats[0]) / bs[bs.length - 1][1] * 100*pc / (ed2 ? 2 : 1)));
    }
        pmb = true;
        clearInterval(interval);
document.getElementById("select_player").style.opacity = "0";
                        document.getElementById("select_player").style.animation = "fade_out 0.4s";
                        document.getElementById("select_player1").style.opacity = "0";
                        document.getElementById("select_player1").style.cursor = "";
                        document.getElementById("select_player2").style.opacity = "0";
                        document.getElementById("select_player2").style.cursor = "";
                         move("player", "basic");
                         return;
  }, false);
                            
                        }, 1);
                        
                    }
                    else{
                        move("player", "basic");
                        pmb = true;
                        if(attackName == "Paw Slash"){
                            hpbarChange("enemy1", -er(stats[0] / bs[bs.length - 1][0] * 100 * pc / (ed1 ? 2 : 1)));
                            pc = 1;
                        }
                        else{
                            hpbarChange("enemy1", -er((1.5 * stats[0]) / bs[bs.length - 1][0] * 100 * pc / (ed1 ? 2 : 1)));
                            pc = 1;
                        }
                    }
                }
                if(attackName == "Pounce"){
                    hpbarChange("enemy1", -er((2 * stats[0]) / bs[bs.length - 1][0] * 100*pc / (ed1 ? 2 : 1)));
                    if(bs[0].length == 3){
                        hpbarChange("enemy2", -er((2 * stats[0]) / bs[bs.length - 1][1] * 100*pc / (ed2 ? 2 : 1)));
                    }
                    move("player", "basic");
                    pmb = true;
                }
                if(attackName == "Werewolf"){
                    hpbarChange("enemy1", -er((250*pc) / bs[bs.length - 1][0] * 100 / (ed1 ? 2 : 1)));
                    if(bs[0].length == 3){
                        hpbarChange("enemy2", -er((250) / bs[bs.length - 1][1] * 100 / (ed2 ? 2 : 1)));
                    }
                    move("player", "basic");
                    pmb = true;
                }
                if(attackName == "Lick Wounds"){
                    hpbarChange("player", er((stats[1]) / (stats[1]*5) * 100));
                    move("player", "heal");
                    pmb = true;
                }
                if(attackName == "Rest"){
                    hpbarChange("player", er(2.5*(stats[1]) / (stats[1]*5) * 100));
                    move("player", "heal");
                    pmb = true;
                }
                if(attackName == "Meditate"){
                    var hpBar = document.getElementById("player_hpbar");
                    hpbarChange("player", er(parseInt(hpBar.style.width, 10)));

                    move("player", "heal");
                    pmb = true;
                }
                if(attackName == "Moonlight"){
                    var hpBar = document.getElementById("player_hpbar");
                    hpbarChange("player", 1000);

                    move("player", "heal");
                    move("player", "buff");
                    pmb = true;
                }
                if(attackName == "Defend" || attackName == "Skip"){
                    var hpBar = document.getElementById("player_hpbar");
                    pd = true;
                    move("player", "buff");
                    
                    pmb = true;
                }
                if(attackName == "Energetic"){
                    var hpBar = document.getElementById("player_hpbar");
                    pE = 5;
                    move("player", "buff");
                    
                    pmb = true;
                }
                if(attackName == "Charge"){
                    var hpBar = document.getElementById("player_hpbar");
                    pc = 1.5;
                    move("player", "buff");
                    
                    pmb = true;
                }
                energy(pe);
            }
            
            //Displays stats in the move box
            function nextMove(){
                document.getElementById("curr_move").innerHTML = moves[(((moves.indexOf(document.getElementById("curr_move").innerHTML)) + 1) % moves.length)];
                displayStat();
            }
            
            //Rounds damage to be an even number, due to an inconvenience from prior code ._.
            function er(n){
                return Math.round(n) + Math.round(n) % 2;
            }
            
            //Upgrade stats
            function us(s){
                
                if(document.getElementById("up").innerHTML == 0){
                    return;
                }
                document.getElementById("up").innerHTML--;
                if(s == 0){
                    stats[0] += 4;
                    document.getElementById("power_stat").innerHTML = stats[0];
                }
                if(s == 1){
                    stats[1] += 4;
                    document.getElementById("vitality_stat").innerHTML = stats[1];
                }
                if(s == 2){
                    stats[2]++;
                    document.getElementById("speed_stat").innerHTML = stats[2];
                }
            }
            
            //Get a new move
            function rm(m){
                if(!cbm){
                    return;
                }
                if(m == 0){
                    if(r_moves[0][am] == ""){
                        return;
                    }
                    moves.push(r_moves[0][am]);
                    am += 2;
                    document.getElementById("amd").innerHTML =r_moves[0][am] + r_moves[0][am+1]
                    cbm = false;
                    document.getElementById("am").style.opacity = 0.5;
                    document.getElementById("hm").style.opacity = 0.5;
                    document.getElementById("bm").style.opacity = 0.5;
                }
                if(m == 1){
                    if(r_moves[1][hm] == ""){
                        return;
                    }
                    moves.push(r_moves[1][hm]);
                    hm += 2;
                    document.getElementById("hmd").innerHTML =r_moves[1][hm] + r_moves[1][hm+1]
                    cbm = false;
                    document.getElementById("am").style.opacity = 0.5;
                    document.getElementById("hm").style.opacity = 0.5;
                    document.getElementById("bm").style.opacity = 0.5;
                }
                if(m == 2){
                    if(r_moves[1][bm] == ""){
                        return;
                    }
                    moves.push(r_moves[2][bm]);
                    bm += 2;
                    document.getElementById("bmd").innerHTML =r_moves[2][bm] + r_moves[2][bm+1]
                    cbm =false;
                    document.getElementById("am").style.opacity = 0.5;
                    document.getElementById("hm").style.opacity = 0.5;
                    document.getElementById("bm").style.opacity = 0.5;
                }
            }
            
            //Display stats
            function displayStat(){
                var move = document.getElementById("curr_move").innerHTML;
                var energy = document.getElementById("en");
                var stat = document.getElementById("stat");
                if(move == "Pass"){
                    energy.innerHTML = 0;
                    stat.innerHTML = "Skip turn"
                }
                if(move == "Paw Slash"){
                    stat.innerHTML = er(stats[0]*pc) + " dmg";
                    energy.innerHTML = 1;
                }
                if(move == "Bite"){
                    stat.innerHTML = er(stats[0] * 1.3*pc) + " dmg";
                    energy.innerHTML = 3;
                }
                if(move == "Pounce"){
                    stat.innerHTML = er(stats[0] * 2*pc) + " dmg";
                    energy.innerHTML = 5;
                }
                if(move == "Werewolf"){
                    stat.innerHTML = 250*pc + " dmg";
                    energy.innerHTML = 10;
                }
                
                if(move == "Lick Wounds"){
                    stat.innerHTML = er(stats[1]) + " heal";
                    energy.innerHTML = 1;
                }
                if(move == "Rest"){
                    stat.innerHTML = er(stats[1] * 2.5) + " heal";
                    energy.innerHTML = 4;
                }
                if(move == "Meditate"){
                    stat.innerHTML = "double HP";
                    energy.innerHTML = 6;
                }
                if(move == "Moonlight"){
                    stat.innerHTML = "Full heal";
                    energy.innerHTML = 10;
                }

                if(move == "Defend"){
                    stat.innerHTML = "50% less dmg";
                    energy.innerHTML = 1;
                }
                if(move == "Energetic"){
                    stat.innerHTML = "+1 energy";
                    energy.innerHTML = 0;
                }
                if(move == "Charge"){
                    stat.innerHTML = "x1.5 dmg";
                    energy.innerHTML = 3;
                }
                if(move == "Skip"){
                    stat.innerHTML = "50% less dmg";
                    energy.innerHTML = 0;
                }
                stat.innerHTML = "- " + stat.innerHTML;
            }
            
            //Next level!
            function nextRound(){
                document.getElementById("upgrade").style.top="-150px";
                var dep = document.getElementsByClassName('energy_point');

                while(dep[0]) {
                    dep[0].parentNode.removeChild(dep[0]);
                }
                var da = document.getElementsByClassName('battle_item');

                while(da[0]) {
                    da[0].parentNode.removeChild(da[0]);
                }
                level++;
                if(level == 1){
                    bs = [
                [[0, stats[2]], [1, 1]],
                ["basic", 20],
                [30]
            ];
                    makeBattle(2, 0, 3, 0, -1, 0, bs);
                }
                if(level == 2){
                    bs = [
                        [[0, stats[2]], [1, 1], [2, 1]],
                        ["basic", 20],
                        ["basic", 20],
                        [30, 30]
                    ];
                    makeBattle(2, 0, 1, 0, 4, 0, bs);
                }
                if(level == 3){
                    bs = [
                        [[0, stats[2]], [1, 1], [2, 1]],
                        ["basic", 20],
                        ["aequor_bubbles", 30],
                        [30, 50]
                    ];
                    makeBattle(2, 1, 0, 2, 4, 2, bs);
                }
                if(level == 4){
                    bs = [
                        [[0, stats[2]], [1, 3], [2, 1]],
                        ["magus_magic", 20, "basic", 5, "buff", 0],
                        ["basic", 30],
                        [70, 50]
                    ];
                    makeBattle(2, 1, 3, 2, 0, 2, bs);
                }
                if(level == 5){
                    bs = [
                        [[0, stats[2]], [1, 4]],
                        ["magus_magic", 65, "buff", 16],
                        [300]
                    ];
                    makeBattle(2, 2, 3, 2, -1, 2, bs);
                }
                if(level == 6){
                    bs = [
                        [[0, stats[2]], [1, 7]],
                        ["buff", 30],
                        [325]
                    ];
                    makeBattle(2, 2, 5, 2, -1, 2, bs);
                }
                if(level == 7){
                    bs = [
                        [[0, stats[2]], [1, 4]],
                        ["fireball", 65],
                        [350]
                    ];
                    makeBattle(2, 3, 1, 2, -1, 2, bs);
                }
                if(level == 8){
                    bs = [
                        [[0, stats[2]], [1, 4], [2, 5]],
                        ["buff", 15, "fireball", 30],
                        ["fireball", 20, "buff", 20],
                        [300, 250]
                    ];
                    makeBattle(2, 3, 5, 3, 1, 2, bs);
                }
                if(level == 9){
                    bs = [
                        [[0, stats[2]], [1, 4]],
                        ["aequor_bubbles", 50, "buff", 15],
                        [400]
                    ];
                    makeBattle(2, 4, 4, 2, -1, 2, bs);
                }
                if(level == 10){
                    bs = [
                        [[0, stats[2]], [1, 10]],
                        ["magus_magic", 120, "buff", 0, "buff", 30, "basic", 30],
                        [500]
                    ];
                    makeBattle(2, 4, 3, 4, -1, 0, bs);
                }
                if(level == 11){
                    document.body.innerHTML = '';
                                document.body.style.background = "black";
                                document.body.innerHTML = "Impressive. You have beat the game. Personally, I thought you would not be able to. Anyways. Go check out Team Altum's other amazing programs.";
                }
            }
            
            //Starts the game (the level variable is initially set to 0 so next round would play the first (0 + 1) level)
            nextRound();
</script>

</html>
